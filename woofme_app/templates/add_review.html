{% extends 'base.html' %}
{% block content %}
<h1>Add review</h1>
{% if user.is_authenticated %}
{% if error_message %}
<div class="alert alert-warning alert-dismissible fade show" role="alert" id="alert">
    <p><strong>{{ error_message }} </strong></p>{% endif %}
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
</div>
<fieldset>

    <div class="container mt-2">

        <div class="bg-dark bg-opacity-75 col-lg-9 col-11 m-auto rounded">
            <h1 class="text-light text-center bold p-3"> Add a breed review</h1>
            <div class="text-light">
                <form method="POST" actions="/add_review" enctype="multipart/form-data">
                    {% csrf_token %}
                    <div class="m-2 align-middle field_container">

                        Breed Group:  &nbsp;{{ review_form.breed_group}}
                        <!------------------------------------------------ Button trigger create a beer style modal -->
                        <button type="button" class="btn btn-primary" data-bs-toggle="modal"
                            data-bs-target="#breedgroupmodal">
                            Create Breed Group
                        </button>
                    </div>

                    <br />
                    <div class="m-2 align-middle p-2">

                        Breed : {{review_form.breed}}<br /> <button type="button" class="btn btn-primary"
                            data-bs-toggle="modal" data-bs-target="#breedmodal">
                            Create Breed
                        </button>
                    </div>
                    <br /><br />
                    <div class="text-center">
                    Write your review : {{ review_form.review }}<br /> </div>
                    <div class="mt-2 field_container">
                        
                        Adaptability : {{ review_form.adaptability }} </div>
                        <div class="mt-2 field_container">

                        Friendliness : {{ review_form.friendliness }} </div>

                        <div class="mt-2 field_container">

                        Trainability : {{ review_form.trainability }} </div>

                        <div class="mt-2 field_container">

                        Health and Grooming Needs : {{ review_form.health_and_grooming_needs }} </div>

                        <div class="mt-2">
                        Add your breed picture: {{ review_form.breed_image }} </div>
                        
                        <div class="mt-2">
                        {{ review_form.rating}} </div>

                    </div>
                    <div class="text-center p-2">
                        <input type="submit" value="Save your review"
                            class="btn btn-secondary btn-success login-button btn-lg ">
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
</fieldset>
<fieldset>
    <!------------------------------------------------------ Breed Group Modal -------------------------------->
    <div class="modal fade" id="breedgroupmodal" tabindex="-1" aria-labelledby="BreedGroupModal" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="BreedGroupModalLabel">Create a Breed Group</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">

                    <form method="POST" actions="/add_review">
                        {% csrf_token %}
                        {{ group_form }}
                        <!------------------------------------------- Button trigger modal ----------------------------->
                        <div class="m-2 text-center">
                            <input name="comment" class="btn btn-success" type="submit" value="Submit" />
                            </button> </div>
                    </form>
</fieldset>

<fieldset>
    <!---------------------------------------------------- Breed Modal --------------------------------------->
    <div class="modal fade" id="breedmodal" tabindex="-1" aria-labelledby="BreedModal" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="BreedModalLabel">Add your breed</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">

                    <form method="POST" actions="">
                        {% csrf_token %}
                        {{ breed_form.breed_name }}
                        <!------------------------------------------- Button trigger modal ----------------------------->
                        <div class="m-2 text-center">
                            <input name="comment" class="btn btn-success " type="submit" value="Create" />
                            </button></div>
                    </form>
</fieldset>

{% endif %}
{% endblock content %}
{% block extrascripts %}



<script type="text/javascript">
    $(function () {

        // Create book synchronous
        function createBeerStyleSyncModalForm() {
            $("#create-style-sync").modalForm({
                formURL: "{% url 'create_style' %}",
                modalID: "#create-modal"
            });
        }
        createBeerstyleSyncModalForm();

        // Create book asynchronous button
        // message
        var asyncSuccessMessageCreate = [
            "<div ",
            "style='position:fixed;top:0;z-index:10000;width:100%;border-radius:0;' ",
            "class='alert alert-icon alert-success alert-dismissible fade show mb-0' role='alert'>",
            "Success: Beer Style was created.",
            "<button type='button' class='close' data-dismiss='alert' aria-label='Close'>",
            "<span aria-hidden='true'>&times;</span>",
            "</button>",
            "</div>",
            "<script>",
            "$('.alert').fadeTo(2000, 500).slideUp(500, function () {$('.alert').slideUp(500).remove();});",
            "<\/script>"
        ].join("");

        // modal form
        function createBreedGroupAsyncModalForm() {
            $("#create-breed-group-async").modalForm({
                formURL: "{% url 'create_breed-group' %}",
                modalID: "#create-modal",
                asyncUpdate: true,
                asyncSettings: {
                    closeOnSubmit: true,
                    successMessage: asyncSuccessMessageCreate,
                    dataUrl: "add_review/",
                    dataElementId: "#group-table",
                    dataKey: "table",
                    addModalFormFunction: reinstantiateModalForms
                }
            });
        }
        createBookAsyncModalForm();



        function reinstantiateModalForms() {
            createBookAsyncModalForm();

        }

        // Filter books button
        $("#filter-book").each(function () {
            $(this).modalForm({
                formURL: $(this).data("form-url")
            });
        });

        // Hide message
        $(".alert").fadeTo(2000, 500).slideUp(500, function () {
            $(".alert").slideUp(500);
        });
    });
</script>
{% endblock extrascripts %}
